---
title: "Final_Project"
author: "Yen Wang and Nathan Frank"
date: "5/2/2022"
output: html_document
---

Final Project
Yen Wang and Nathan Frank

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(rvest)
library(tidyverse)
library(lubridate)
```

1.US minimum Wage by State from 1968 to 2017 https://www.kaggle.com/datasets/lislejoem/us-minimum-wage-by-state-from-1968-to-2017
This data set lists the minimum wage in every state in the U.S. from 1968 until 2017.

2.U.S. Inflation Rate 1960-2022
https://www.macrotrends.net/countries/USA/united-states/inflation-rate-cpi
This website shows the inflation rate in the United States in a similar time period as our first data set.

Cleaning: The firs tdata set includes U.S. territories such as Puerto Rico and the U.S. Virgin Islands which will not be included since we are only looking at states on our maps.

```{r}
mwd <- read.csv("Minimum Wage Data.csv")
mwd = mwd %>% filter(State != "Puerto Rico")
mwd = mwd %>% filter(State != "U.S. Virgin Islands")
head(mwd)

url = "https://www.macrotrends.net/countries/USA/united-states/inflation-rate-cpi"
html <- read_html(url)
tables = html %>% html_table(fill = TRUE)
rl = tables[[2]]
names(rl)[1] = "Year"
names(rl)[2] = "Inflation Rate (%)"
names(rl)[3] = "Annual Change"
rl1 <- rl[-c(1), ]
head(rl1)
```

```{r}
str(mwd)
str(rl1)
rl2 = rl1 %>% mutate(`Inflation Rate (%)` = parse_number(`Inflation Rate (%)`), 
               `Annual Change` = parse_number(`Annual Change`), 
               Year = as.factor(Year))
mwd = mwd %>% mutate(Year = as.factor(Year))

```


## The average minimum wage of every state through out the years
```{r}
mwd.state = mwd %>% group_by(State) %>% 
  summarise(m.state = mean(State.Minimum.Wage.2020.Dollars, na.rm = TRUE)) %>%
  arrange(desc(m.state))

mwd.state %>% ggplot(aes(x = State)) + 
  geom_bar(aes(weight = m.state)) + 
  coord_flip() + 
  ylab("State Minimum Wage")

```

## The average minimum wage through out the years

```{r}
mwd.year = mwd %>% group_by(Year) %>% 
  summarise(m.year = mean(State.Minimum.Wage, na.rm = TRUE), 
            m.year.2020 = mean(State.Minimum.Wage.2020.Dollars, na.rm = TRUE))

mwd.year %>% ggplot(aes(x = Year)) + 
  geom_bar(aes(weight = m.year)) + 
  coord_flip() + 
  ylab("State Minimum Wage")

mwd.year %>% ggplot(aes(x = Year)) + 
  geom_bar(aes(weight = m.year.2020)) + 
  coord_flip() + 
  ylab("State Minimum Wage in 2020 Dollars")



```

```{r}
mwd.enforced = mwd %>% group_by(State) %>% 
  summarise(m.high = mean(Department.Of.Labor.Cleaned.High.Value.2020.Dollars, na.rm = TRUE), 
            m.low = mean(Department.Of.Labor.Cleaned.Low.Value.2020.Dollars, na.rm = TRUE))

head(mwd.enforced)
```



